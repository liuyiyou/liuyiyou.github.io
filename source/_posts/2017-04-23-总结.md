date: "2017-04-23"
categories: 
  - 总结
title: 2017-04-23总结
tags : 
 - 总结
---


查看mr日志

```sh


hadoop fs -ls /tmp/logs/hadoop/logs/application_1489562118320_201347/

hadoop fs -cat  /tmp/logs/hadoop/logs/application_1489562118320_201347/37-15-38.cluster-main.djdns.cn_18041|more

yarn logs -applicationId  application_1489562118320_201347


```

```sql

alter table dm_oms_t_order_final  add columns (sign_total_amount  double  COMMENT '签单总额');

alter table app_oms_order_quota  add columns (sign_total_amount  double  COMMENT '签单总额-不变');

alter table app_crm_all_summary2  add columns (sign_total_amount  double  COMMENT '签单总额-不变');


```

查询Hbase

```java

public static void queryHbase(String workerId) throws IOException {
        Map<String, Integer> result = Maps.newLinkedHashMap();
        Configuration config = HBaseConfiguration.create(conf);
        ResultScanner rs = null;
        HTable table = null;
        try {
            table = new HTable(config, "user_score_quota");
            // table.get(get);

            // 查询主键
            Get get = new Get(Bytes.toBytes(workerId));
            Result r = table.get(get);
            if (r == null)
                return;
            /**
             * result对象不为空， 但result.getRow() == null, 也说明上一步没有查到对应条件的任何记录，直接返回了
             */
            byte[] srcTbRowkey = r.getRow();
            if (srcTbRowkey == null)
                return;

            // 循环所有的列
            logger.info("worker_id:{} 结果集如下: ", workerId);
            List<Cell> cellList = r.listCells();
            for (Cell cell : cellList) {
                String cc = Bytes.toString(CellUtil.cloneQualifier(cell));
                if (Character.isDigit(cc.charAt(0)))
                    logger.info("积分列: {}, 积分值： {}", Bytes.toString(CellUtil.cloneQualifier(cell)),
                            Bytes.toInt(CellUtil.cloneValue(cell)));
                else
                    logger.info("积分列: {}, 积分值： {}", Bytes.toString(CellUtil.cloneQualifier(cell)),
                            Bytes.toString(CellUtil.cloneValue(cell)));
            }
            logger.info("===============END==================");
        } catch (Exception e) {
            logger.error(e.getMessage(), e);
        } finally {
            if (rs != null) {
                rs.close();
                rs = null;
            }

            if (table != null)
                table.close();
        }
    }



```