title: JSON日期转换
date: 2015-10-27
categories : 
  - java
tags : 
  - json
---

这个在 [2015-05-17总结](/2015/05/17/2015-05-17总结/) 中有写过

在使用Ajax返回json的时候，对于日期，并不会返回一个mysql表中的yyyy-MM-dd这样格式的日期，而是返回一个对象。如果实体类的字段是string类型还好，在后台for循环查询出来的列表，然后使用DateFormat进行将日期转换为string类型，但是如果是Date类型的话，还真不好转。

我就遇到了这个问题，通过注解发现问题没有解决。最后采用如下方式解决了问题。

需要注意的是，用到了类是来自json-lib.jar中

<!--more-->

以下代码只是为了说明，实际情况并不如此。

```java

import net.sf.json.JSONArray;
import net.sf.json.JSONObject;
import net.sf.json.JsonConfig;
import net.sf.json.processors.JsonValueProcessor;



public class JsonDateTest(){
     public static void main(String args[]){
         List<Student> list =  //来自数据中的列表，里面包含Date类型的字段。
         JsonConfig jsonConfig =     new JsonConfig();
         jsonConfig.registerJsonValueProcessor(java.util.Date.class,new JsonValueProcessor() {
            private final String format="yyyy-MM-dd hh:mm:ss";
            public Object processObjectValue(String key, Object value,JsonConfig arg2){
              if(value==null)
                    return "";
              if (value instanceof java.util.Date) {
                    String str = new SimpleDateFormat(format).format((java.util.Date) value);
                    return str;
              }
                    return value.toString();
            }
      
            public Object processArrayValue(Object value, JsonConfig arg1){
                       return null;
            }
            
         });
         //之前使用的是 JSONArray array = JSONArray.fromObject(list);
        JSONArray array = JSONArray.fromObject(list,jsonConfig);
   }
}      


```

如果后续有其他更为简单的方法，也会更新上来。

@Jsonformat(parttrn="yyyy-MM-dd")

不过这个要配合JsonUtils来使用

```java

@JsonFormat(pattern = "yyyy-MM-dd")
  private Date date;


  User user = new User();
    user.setDate(new Date());
    user.setName("liuyiyou");
    ObjectMapper objectMapper = new ObjectMapper();
    System.out.println(objectMapper.writeValueAsString(user));


```
需要说明的是：不是用的SpringMVC，而是使用的内部框架。









